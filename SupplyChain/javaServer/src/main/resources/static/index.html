<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token() }}">

    <title>Online Registration</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.bunny.net">
    <link href="https://fonts.bunny.net/css?family=figtree:400,500,600&display=swap" rel="stylesheet" />

    <!-- Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

    <style>
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #e0e7ff 0%, #f8fafc 100%);
            font-family: 'Figtree', 'Open Sans', 'Helvetica Neue', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-input {
            background: #f1f5f9 !important;
            border: 2px solid #e5e7eb !important;
            color: #1e293b !important;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            width: 100%;
            margin-bottom: 1rem;
            transition: border-color 0.2s;
        }

        .login-outer-container {
            width: 100vw;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
        }

        .login-card {
            display: flex;
            flex-direction: row;
            background: #fff;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            border-radius: 1.5rem;
            overflow: hidden;
            max-width: 800px;
            width: 100%;
            min-height: 500px;
            max-height: 600px;
        }

        .login-card-left {
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 240px;
            width: 38%;
            padding: 2rem 1rem;
        }

        .login-logo-img {
            max-width: 140px;
            width: 100%;
            height: auto;
            display: block;
        }

        .login-card-right {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .login-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1e293b;
            text-align: center;
            line-height: normal;
            margin-top: 20px;
        }

        .login-subtitle {
            font-size: 1.125rem;
            color: #64748b;
            margin-bottom: 2rem;
        }

        .step-transition {
            transition: transform 0.4s ease-in-out, opacity 0.4s ease-in-out;
        }

        .step-hidden-left {
            transform: translateX(-100%);
            opacity: 0;
            position: absolute;
            width: 100%;
        }

        .step-hidden-right {
            transform: translateX(100%);
            opacity: 0;
            top: 0;
            position: absolute;
            width: 100%;
        }

        .step-active {
            transform: translateX(0);
            opacity: 1;
            position: relative;
        }

        @media (max-width: 900px) {
            .login-card {
                max-width: 98vw;
            }
        }

        @media (max-width: 700px) {
            .login-card {
                flex-direction: column;
                min-height: unset;
            }

            .login-card-left,
            .login-card-right {
                width: 100%;
                min-width: unset;
                padding: 2rem 1rem;
            }

            .login-card-left {
                justify-content: center;
                border-bottom: 1px solid #e5e7eb;
            }
        }

        @media (max-width: 500px) {
            .login-card {
                border-radius: 0.5rem;
            }

            .login-title {
                font-size: 1.5rem;
            }

            .login-card-left,
            .login-card-right {
                padding: 1.25rem 0.5rem;
            }
        }
    </style>

</head>

<body>
    <div class="login-outer-container">
        <div class="login-card">
            <div class="login-card-left"
                style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <img src="http://localhost:8080/CA-WORD.png" alt="ChicAura Logo"
                    class="h-auto w-[150px] drop-shadow-lg">
                <div class="login-title">Online User Registration</div>
                <div class="login-welcome"
                    style="margin-top: 10px; color: #475569; font-size: 1rem; text-align: center;">
                    Join our elite team and help manage the ChicAura supply chain ecosystem
                </div>
            </div>
            <div class="login-card-right">
                <form id="multiStepForm" class="py-4 px-10 bg-white relative overflow-hidden"
                    action="{{ route('register.newUser') }}" method="POST" enctype="multipart/form-data">
                    @csrf

                    <!-- Circle progress bar -->
                    <div class="flex items-center justify-between mb-6 relative">
                        <div class="absolute top-1/2 left-0 right-0 h-1 bg-gray-300 z-0"></div>
                        <div id="stepCircle1"
                            class="z-10 w-8 h-8 cursor-pointer flex items-center justify-center rounded-full text-white bg-green-500">1
                        </div>
                        <div id="stepCircle2"
                            class="z-10 w-8 h-8 cursor-pointer flex items-center justify-center rounded-full text-white bg-gray-400">2
                        </div>
                        <div id="stepCircle3"
                            class="z-10 w-8 h-8 cursor-pointer flex items-center justify-center rounded-full text-white bg-gray-400">3
                        </div>
                        <div id="stepCircle4"
                            class="z-10 w-8 h-8 cursor-pointer flex items-center justify-center rounded-full text-white bg-gray-400">4
                        </div>
                        <div id="stepCircle5"
                            class="z-10 w-8 h-8 cursor-pointer flex items-center justify-center rounded-full text-white bg-gray-400">5
                        </div>
                        <div id="stepCircle6"
                            class="z-10 w-8 h-8 cursor-pointer flex items-center justify-center rounded-full text-white bg-gray-400">6
                        </div>
                    </div>

                    <div class="step step-transition step-active" data-step="1">
                        <p class="text-2xl font-bold">Section A: Company Details</p>
                        <div class="grid lg:grid-cols-2 gap-4 mt-2">
                            <div class="h-[60px]">
                                <label for="companyName" class="form-label block text-base font-medium">Company /
                                    Firm
                                    Name</label>
                                <div class="mt-1">
                                    <input id="companyName" name="companyName" type="text" placeholder="John Suppliers"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>

                            <div class="h-[60px]">
                                <label for="businessEmail" class="form-label block text-base font-medium">Business
                                    Email</label>
                                <div class="mt-1">
                                    <input id="businessEmail" name="businessEmail" type="email" autocomplete="email"
                                        placeholder="eg.john@gmail.com"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>

                            <div class="h-[60px]">
                                <label for="address" class="form-label block text-base font-medium">Address</label>
                                <div class="mt-1">
                                    <input id="address" name="address" type="text" placeholder="Kampala, Uganda"
                                        class="form-input block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>

                            <div class="h-[60px]">
                                <label for="role" class="form-label block text-base font-medium">Role</label>
                                <div class="mt-1">
                                    <select id="role" name="role"
                                        class="form-input block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                        <option value="supplier">Supplier</option>
                                        <option value="wholesaler">Wholesaler</option>
                                    </select>
                                </div>

                            </div>
                            <div class="h-[60px]">
                                <label for="phoneNumber" class="form-label block text-base font-medium">Phone
                                    Number</label>
                                <div class="mt-1">
                                    <input id="phoneNumber" name="phoneNumber" type="text" placeholder="+256 772 345678"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                            <div class="h-[60px]">
                                <label for="dateEstablished" class="form-label block text-base font-medium">Date
                                    Established</label>
                                <div class="mt-1">
                                    <input id="dateEstablished" name="dateEstablished" type="text" placeholder="Jan 10 24, 02/06/24"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                            <div
                                class="role-fields wholesaler h-[60px] transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden">
                                <label for="inventoryCapacity" class="form-label block text-base font-medium">Inventory
                                    Capacity
                                </label>
                                <div class="mt-1">
                                    <input id="inventoryCapacity" name="inventoryCapacity" type="number"
                                        placeholder="warehouse sq. ft"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                            <div class="h-[60px]">
                                <label for="ursbNumber" class="form-label block text-base font-medium">URSB
                                    Registration
                                    Number</label>
                                <div class="mt-1">
                                    <input id="ursbNumber" name="ursbNumber" type="text" placeholder="800200034567899"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                            <div class="h-[60px]">
                                <label for="tin" class="form-label block text-base font-medium">TIN</label>
                                <div class="mt-1">
                                    <input id="tin" name="tin" type="text" placeholder="100034536478"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                            <div class="h-[60px]">
                                <label for="licenseNumber" class="form-label block text-base font-medium">Trading
                                    License
                                    Number</label>
                                <div class="mt-1">
                                    <input id="licenseNumber" name="licenseNumber" type="text" placeholder=""
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="step step-transition step-hidden-right space-y-4" data-step="2">
                        <p class="text-2xl font-bold">Section B: Principal Contact</p>
                        <div>
                            <label for="contactName" class="form-label block text-base font-medium">Full
                                Name</label>
                            <div class="mt-1">
                                <input id="contactName" name="contactName" type="text" placeholder="John Wick"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                        <div>
                            <label for="contactTitle" class="form-label block text-base font-medium">Title</label>
                            <div class="mt-1">
                                <input id="contactTitle" name="contactTitle" type="text" placeholder="CEO"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                        <div>
                            <label for="contactEmail" class="form-label block text-base font-medium">Email
                                Address</label>
                            <div class="mt-1">
                                <input id="contactEmail" name="contactEmail" type="email" autocomplete="email"
                                    placeholder="wick@gmail.com"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                        <div>
                            <label for="contactPhone" class="form-label block text-base font-medium">Contact
                                Number</label>
                            <div class="mt-1">
                                <input id="contactPhone" name="contactPhone" type="text" placeholder="+256 772 345678"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                    </div>

                    <div class="step step-transition step-hidden-right space-y-4" data-step="3">
                        <p
                            class="role-fields supplier transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden text-2xl font-bold">
                            Section C: Material & Quality Specifications</p>
                        <p
                            class="role-fields wholesaler transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden text-2xl font-bold">
                            Section C: Sales, Distribution & Quality Specifications</p>

                        <div
                            class="role-fields supplier transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden">
                            <label for="materialSupplied" class="form-label block text-base font-medium">Material
                                Supplied</label>
                            <div class="mt-1">
                                <textarea name="materialSupplied" id="materialSupplied" placeholder="Cotton, Silk, Nylon"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base"></textarea>
                            </div>
                        </div>
                        <div class="grid lg:grid-cols-2 gap-4 mt-2">
                            <div
                                class="role-fields supplier h-[45px] transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden">
                                <label for="leadTimes" class="form-label block text-base font-medium">Lead Time
                                    (days)</label>
                                <div class="mt-1">
                                    <input id="leadTimes" name="leadTimes" type="number" placeholder="23"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                            <div
                                class="role-fields supplier h-[45px] transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden">
                                <label for="minOrderVolume" class="form-label block text-base font-medium">Minimum
                                    Supply
                                    Quantity</label>
                                <div class="mt-1">
                                    <input id="minOrderVolume" name="minOrderVolume" type="number" placeholder="65"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                        </div>
                        <div
                            class="role-fields wholesaler transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden">
                            <label for="salesVolume" class="form-label block text-base font-medium">Annual Sales
                                Volume</label>
                            <div class="mt-1">
                                <input id="salesVolume" name="salesVolume" type="number" placeholder="100000"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                        <div class="grid lg:grid-cols-2 gap-4">
                            <div
                                class="role-fields wholesaler h-[45px] mb-4 transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden">
                                <label for="retailerOutletNo" class="form-label block text-base font-medium">Number
                                    Of
                                    Retail Outlets</label>
                                <div class="mt-1">
                                    <input id="retailerOutletNo" name="retailerOutletNo" type="number" placeholder="4"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                            <div
                                class="role-fields wholesaler h-[45px] mb-4 transition-all duration-500 ease-in-out transform opacity-0 scale-95 hidden">
                                <label for="minOrderVolume" class="form-label block text-base font-medium">Minimum
                                    Order
                                    Value</label>
                                <div class="mt-1">
                                    <input id="minOrderVolume" name="minOrderVolume" type="number" placeholder="200 units"
                                        class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                                </div>
                            </div>
                        </div>
                        <div>
                            <label for="employeeNo" class="form-label block text-base font-medium">Number Of
                                Employees</label>
                            <div class="mt-1">
                                <input id="employeeNo" name="employeeNo" type="number" placeholder="50"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                        <div>
                            <label for="qualityLicenses" class="form-label block text-base font-medium">Quality
                                Standards & Certifications</label>
                            <div class="mt-1">
                                <textarea name="qualityLicenses" id="qualityLicenses" placeholder="ISO 9034"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="step step-transition step-hidden-right space-y-4" data-step="4">
                        <p class="text-2xl font-bold">Section D: Financial Information</p>
                        <div>
                            <label for="netAssets" class="form-label block text-base font-medium">Net Assets</label>
                            <div class="mt-1">
                                <input id="netAssets" name="netAssets" type="number" placeholder="400000000"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                        <div>
                            <label for="annualTurnover" class="form-label block text-base font-medium">Annual
                                Turnover</label>
                            <div class="mt-1">
                                <input id="annualTurnover" name="annualTurnover" type="number" placeholder="200000000"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                        <div>
                            <label for="bankReference" class="form-label block text-base font-medium">Bank
                                Reference</label>
                            <div class="mt-1">
                                <input id="bankReference" name="bankReference" type="text" placeholder="Bank Reference"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                    </div>

                    <div class="step step-transition step-hidden-right space-y-4" data-step="5">
                        <p class="text-2xl font-bold">Section E: Reputation And Regulatory Complaince</p>
                        <div>
                            <label for="awards" class="form-label block text-base font-medium">Awards</label>
                            <div class="mt-1">
                                <textarea name="awards" id="awards"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base"
                                    placeholder="Best Trader"></textarea>
                            </div>
                        </div>
                        <div>
                            <label for="numComplaints" class="form-label block text-base font-medium">Complaints</label>
                            <div class="mt-1">
                                <input id="numComplaints" name="numComplaints" type="number" placeholder="2"
                                    class="form-input appearance-none block w-full px-3 py-2 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-base">
                            </div>
                        </div>
                    </div>

                    <div class="step step-transition step-hidden-right space-y-4" data-step="6">
                        <p class="text-2xl font-bold">Section F: Attachments</p>
                        <div class="grid lg:grid-cols-4 gap-4 items-end">
                            <div>
                                <label for="certificateOfIncorporation"
                                    class="form-label block text-base font-medium">Certificate of Incorporation
                                    (URSB)</label>
                                <div class="mt-1">
                                    <input id="certificateOfIncorporation" name="certificateOfIncorporation" type="file"
                                        accept="image/png, image/jpeg" placeholder=""
                                        class="form-input w-full lg:col-span-4 px-0 py-3 mb-0 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                </div>
                            </div>
                            <div>
                                <label for="licensePicture" class="form-label block text-base font-medium">Valid
                                    Trading
                                    License</label>
                                <div class="mt-1">
                                    <input id="licensePicture" name="licensePicture" type="file"
                                        accept="image/png, image/jpeg" placeholder=""
                                        class="form-input w-full lg:col-span-4 px-0 py-3 mb-0 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                </div>
                            </div>
                            <div>
                                <label for="tinPicture" class="form-label block text-base font-medium">URA TIN
                                    Certificate</label>
                                <div class="mt-1">
                                    <input id="tinPicture" name="tinPicture" type="file" accept="image/png, image/jpeg"
                                        placeholder=""
                                        class="form-input w-full lg:col-span-4 px-0 py-3 mb-0 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                </div>
                            </div>
                            <div>
                                <label for="vatCertificate" class="form-label block text-base font-medium">VAT
                                    Registration
                                    Certificate</label>
                                <div class="mt-1">
                                    <input id="vatCertificate" name="vatCertificate" type="file"
                                        accept="image/png, image/jpeg"
                                        class="form-input w-full lg:col-span-4 px-0 py-3 mb-0 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                </div>
                            </div>
                            <div>
                                <label for="bankStatement" class="form-label block text-base font-medium">Bank
                                    Statement</label>
                                <div class="mt-1">
                                    <input id="bankStatement" name="bankStatement" type="file"
                                        accept="image/png, image/jpeg" placeholder=""
                                        class="form-input w-full lg:col-span-4 px-0 py-3 mb-0 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                </div>
                            </div>
                            <div>
                                <label for="financialStatements" class="form-label block text-base font-medium">Audited
                                    Financial Statements</label>
                                <div class="mt-1">
                                    <input id="financialStatements" name="financialStatements" type="file"
                                        accept="image/png, image/jpeg"
                                        class="form-input w-full lg:col-span-4 px-0 py-3 mb-0 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                </div>
                            </div>
                            <div>
                                <label for="ids" class="form-label block text-base font-medium">National
                                    IDs/Passports
                                    of
                                    Owners</label>
                                <div class="mt-1">
                                    <input id="ids" name="ids" type="file" accept="image/png, image/jpeg" placeholder=""
                                        class="form-input w-full lg:col-span-4 px-0 py-3 mb-0 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                </div>
                            </div>
                            <div>
                                <label for="qualityCertificatesPics"
                                    class="form-label block text-base font-medium">Quality
                                    Certificates</label>
                                <div class="mt-1">
                                    <input id="qualityCertificatesPics" name="qualityCertificatesPics" type="file"
                                        accept="image/png, image/jpeg" placeholder=""
                                        class="form-input w-full lg:col-span-4 px-0 py-3 mb-0 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="mt-1">
                                <button type="button" onclick="previewPDF()"
                                    class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">Preview
                                    PDF</button>
                            </div>
                        </div>
                    </div>


                    <div class="flex justify-between mt-6 w-full bg-white">
                        <button type="button" id="prevBtn"
                            class="w-full py-2 px-4 mr-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-gray-600 hover:bg-grey-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 hidden">Previous</button>
                        <button type="button" id="nextBtn"
                            class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">Next</button>
                    </div>

                </form>
            </div>
        </div>
    </div>

</body>

</html>
<script>
    let currentStep = 1;
    const totalSteps = 6;
    const form = document.getElementById("multiStepForm");
    const steps = form.querySelectorAll(".step");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    const stepCircles = [
        document.getElementById("stepCircle1"),
        document.getElementById("stepCircle2"),
        document.getElementById("stepCircle3"),
        document.getElementById("stepCircle4"),
        document.getElementById("stepCircle5"),
        document.getElementById("stepCircle6")
    ];

    function updateCircles(step) {
        stepCircles.forEach((circle, index) => {
            if (index + 1 <= step) {
                circle.classList.remove("bg-gray-400");
                circle.classList.add("bg-green-500");
            } else {
                circle.classList.remove("bg-green-500");
                circle.classList.add("bg-gray-400");
            }
        });
    }

    function showStep(step, direction = "next") {
        steps.forEach((s, index) => {
            const stepNum = index + 1;
            s.classList.remove("step-active", "step-hidden-left", "step-hidden-right");
            if (stepNum < step) {
                s.classList.add("step-hidden-left");
            } else if (stepNum > step) {
                s.classList.add("step-hidden-right");
            } else {
                s.classList.add("step-active");
            }
        });

        prevBtn.classList.toggle("hidden", step === 1);
        nextBtn.textContent = step === totalSteps ? "Submit" : "Next";
        updateCircles(step);
    }

    function validateStep(step) {
        const inputs = steps[step - 1].querySelectorAll("input, select");
        for (let input of inputs) {
            if (!input.checkValidity()) {
                input.reportValidity();
                return false;
            }
        }
        return true;
    }

    nextBtn.addEventListener("click", async () => {
        if (currentStep < totalSteps && validateStep(currentStep)) {
            currentStep++;
            showStep(currentStep, "next");
        } else if (currentStep === totalSteps && validateStep(currentStep)) {
            await submitPDF();
        }
    });

    prevBtn.addEventListener("click", () => {
        if (currentStep > 1) {
            currentStep--;
            showStep(currentStep, "prev");
        }
    });

    stepCircles.forEach((circle, index) => {
        circle.addEventListener("click", () => {
            currentStep = index + 1; // update current step
            showStep(currentStep);   // show the selected step
        });
    });

    //Role fields change
    const roleSelect = document.getElementById("role");
    function showRoleFields(role) {
        const allRoleFields = document.querySelectorAll(".role-fields");
        allRoleFields.forEach(el => {
            if (el.classList.contains(role)) {
                el.classList.remove("hidden");
                requestAnimationFrame(() => {
                    el.classList.remove("opacity-0", "scale-95");
                    el.classList.add("opacity-100", "scale-100");
                });
            } else {
                el.classList.remove("opacity-100", "scale-100");
                el.classList.add("opacity-0", "scale-95");
                setTimeout(() => el.classList.add("hidden"), 300);
            }
        });
    }
    roleSelect.addEventListener("change", () => {
        showRoleFields(roleSelect.value);
    });

    // Add Role Fields when page loads
    document.addEventListener('DOMContentLoaded', function () {
        showRoleFields(roleSelect.value);
    });

    //Generate Temp Form
    async function generatePDF(form) {

        const data = new FormData(form);
        const role = data.get('role');

        // 2. Fetch your blank PDF template
        let url;  // adjust path!
        if (role == 'supplier') {
            url = 'http://localhost:8080/PDF2.pdf';
        } else {
            url = 'http://localhost:8080/PDF.pdf';
        }
        const existingPdfBytes = await fetch(url).then(res => res.arrayBuffer());

        // 3. Load PDF with pdf-lib
        const pdfDoc = await PDFLib.PDFDocument.load(existingPdfBytes);
        const pages = pdfDoc.getPages();

        // 4. Set font
        const helveticaFont = await pdfDoc.embedFont(PDFLib.StandardFonts.Helvetica);
        const fontSize = 14;

        // 5. Draw each field at the right coordinates

        if (role == 'supplier') {
            const supplierFields = [
                { name: 'companyName', page: 0, y: 532 }, { name: 'businessEmail', page: 0, y: 485 }, { name: 'address', page: 0, y: 438 },
                { name: 'phoneNumber', page: 0, y: 391 }, { name: 'dateEstablished', page: 0, y: 344 }, { name: 'ursbNumber', page: 0, y: 297 },
                { name: 'tin', page: 0, y: 250 }, { name: 'licenseNumber', page: 0, y: 203 },

                { name: 'contactName', page: 1, y: 583 }, { name: 'contactTitle', page: 1, y: 536 }, { name: 'contactEmail', page: 1, y: 489 },
                { name: 'contactPhone', page: 1, y: 442 }, { name: 'materialSupplied', page: 1, y: 345 }, { name: 'leadTimes', page: 1, y: 270 },
                { name: 'minOrderVolume', page: 1, y: 223 }, { name: 'employeeNo', page: 1, y: 176 }, { name: 'qualityLicenses', page: 1, y: 129 },

                { name: 'netAssets', page: 2, y: 557 }, { name: 'annualTurnover', page: 2, y: 510 }, { name: 'bankReference', page: 2, y: 463 },
                { name: 'awards', page: 2, y: 365 }, { name: 'numComplaints', page: 2, y: 294 }

            ];
            for (let { name, page, y } of supplierFields) {
                pages[page].drawText(data.get(name) || '', {
                    x: 98,
                    y: y,
                    size: fontSize,
                    font: helveticaFont,
                });
            }
        } else {
            const wholesalerFields = [
                { name: 'companyName', page: 0, y: 532 }, { name: 'businessEmail', page: 0, y: 485 }, { name: 'address', page: 0, y: 438 },
                { name: 'phoneNumber', page: 0, y: 391 }, { name: 'dateEstablished', page: 0, y: 344 }, { name: 'inventoryCapacity', page: 0, y: 297 }, { name: 'ursbNumber', page: 0, y: 250 },
                { name: 'tin', page: 0, y: 203 }, { name: 'licenseNumber', page: 0, y: 156 },

                { name: 'contactName', page: 1, y: 557 }, { name: 'contactTitle', page: 1, y: 510 }, { name: 'contactEmail', page: 1, y: 463 },
                { name: 'contactPhone', page: 1, y: 416 }, { name: 'salesVolume', page: 1, y: 292 }, { name: 'retailerOutletNo', page: 1, y: 245 },
                { name: 'minOrderVolume', page: 1, y: 198 }, { name: 'employeeNo', page: 1, y: 151 }, { name: 'qualityLicenses', page: 1, y: 104 },

                { name: 'netAssets', page: 2, y: 533 }, { name: 'annualTurnover', page: 2, y: 486 }, { name: 'bankReference', page: 2, y: 439 },
                { name: 'awards', page: 2, y: 315 }, { name: 'numComplaints', page: 2, y: 243 }
            ];
            for (let { name, page, y } of wholesalerFields) {
                pages[page].drawText(data.get(name) || '', {
                    x: 98,
                    y: y,
                    size: fontSize,
                    font: helveticaFont,
                });
            }
        }

        //handle the image file:
        const imageFields = [
            { name: 'certificateOfIncorporation' }, { name: 'licensePicture' }, { name: 'tinPicture' }, { name: 'vatCertificate' }, { name: 'bankStatement' },
            { name: 'financialStatements' }, { name: 'ids' }, { name: 'qualityCertificatesPics' },
        ];

        for (let { name, label } of imageFields) {
            const fileInput = form.elements[name];
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const imgBytes = await file.arrayBuffer();

                // detect image type and embed appropriately
                let embeddedImage, imgDims;
                if (file.type === 'image/png') {
                    embeddedImage = await pdfDoc.embedPng(imgBytes);
                } else {
                    embeddedImage = await pdfDoc.embedJpg(imgBytes);
                }
                imgDims = embeddedImage.scale(0.6);
                // scale(1) = full size; adjust 0.5, 0.3, etc. as needed

                // decide which page and where to draw it:
                if (name == 'certificateOfIncorporation') {
                    const imagePage = pages[3];
                    const x = 70;                   // tweak to your layout
                    const y = 0;
                    imagePage.drawImage(embeddedImage, {
                        x, y,
                        width: imgDims.width,
                        height: imgDims.height
                    });
                } else {
                    const A4 = [595.28, 841.89];
                    const newPage = pdfDoc.addPage(A4);

                    newPage.drawImage(embeddedImage, { x: 100, y: 0, width: imgDims.width, height: imgDims.height });
                }

            }
        }


        // 6. Serialize the PDF and create a blob URL
        const pdfBytes = await pdfDoc.save();
        return new Blob([pdfBytes], { type: 'application/pdf' });

    }

    async function previewPDF() {
        // 1. Grab form data
        const form = document.getElementById('multiStepForm');
        const blob = await generatePDF(form);
        const blobUrl = URL.createObjectURL(blob);
        window.open(blobUrl, '_blank');
    }

    async function submitPDF() {
        const form = document.getElementById('multiStepForm');
        const pdfBlob = await generatePDF(form);
        const file = new File([pdfBlob], 'onlineFilledForm.pdf', { type: 'application/pdf' });

        // Create a hidden file input
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.name = 'license_document';
		fileInput.className = 'hidden';

        // Use DataTransfer to set the File on the input
        const dataTransfer = new DataTransfer();
        dataTransfer.items.add(file);
        fileInput.files = dataTransfer.files;

        // Append to the form
        form.appendChild(fileInput);

        // Submit the form (native submission, Laravel redirects will work)
        form.submit();


    }


</script>